# Предсказание объёма нефти в скважинах

## Цель проекта: 
построить модель машинного обучения, которая поможет определить регион, где добыча принесёт наибольшую прибыль, проанализировать возможную прибыль и риски техникой Bootstrap. 
 
## Задачи проекта:

1. Импорт необходимых библиотек, чтение набора данных, его первичный анализ.

2. Обучение и проверка модели.

3. Подготовка к расчёту прибыли.

4. Расчёт прибыли и рисков.

## Инструменты:

1. pandas
2. numpy
3. sklearn.train_test_split
4. sklearn.LinearRegression
5. sklearn.mean_squared_error
6. scipy.stats
7. matplotlib

## Основные результаты проекта:

Мы решили в каком регионе, из трёх предложенных, наиболее выгодно бурить скважины.

В процессе исследований мы использовали пробы нефти из трёх регионов. В каждом регионе по 10 тысяч месторождений. Измерили качество нефти и объём запасов.

Мы построили модель машинного обучения линейная регрессия (LinearRegression), которая предсказывает регион с наибольшей прибылью.

Работу над проектом мы вели по плану:

- Импорт библиотек. Загрузка и подготовка данных. Анализ.
- Обучение и проверка модели.
- Подготовка к расчёту прибыли.
- Расчёт прибыли и рисков.


### Импорт библиотек. Загрузка и подготовка данных. Анализ

На данном этапе мы импортировали необходимые библиотеки, а также считали и проанализировали предоставленные наборы данных.

В наборе данных представлены пробы нефти в трёх регионах. По составу наборы данных идентичны друг другу: все три набора данных содержат id скважины, 3 параметра, описывающие некоторые характеристики скважин, а также объём запасов нефти в скважине (в тыс. баррелей).

Каждый набор данных сожержит по 100 тыс. наблюдений.

Данные не содержат аномалий, дубликатов или пропущенных значений, поэтому их предварительная обработка не требуется.


### Обучение и проверка модели

Мы разделили наборы данных на тренировочную и валидационную выборки в соотношении 75 % : 25 %.

Для предсказания объёмов добычи нефти для всех трёх регионов мы построили модель линейной регрессии. Для каждого региона мы расчитали средний запас предсказанного сырья, а также определили метрику RMSE. RMSE и средний запас предсказанного сырья мы оценивали для топ-200 месторождений.

Оптимальное предсказание мы построили для Регион 1. Предсказанный средний запас сырья составил 68.73 тыс.баррелей. Данное предсказание имеет низкое значение ошибки. В среднем, при предсказывании объёма добычи нефти в скважине ошибка модели составляет 0.89 тыс. баррелей.

Данный прогноз предсказывает меньшие по сравнению с другими регионами объёмы добычи нефти, однако это предсказание более точное относительно других регионов.

Регионом с наибольшим риском - можно назвать Регион 2: модель предсказала средний объём добываемой нефти в размере 94.97 тыс. баррелей, при этом в среднем модель ошибается на 40.02 тыс. баррелей при предсказании объёма добычи нефти. Модель предсказывает достаточно высокие объёмы добычи нефти относительно Региона 1, однако эта модель допускает более высокую погрешность при предсказаннии объёмов добычи нефти.


### Подготовка к расчёту прибыли

Мы сохранили ряд ключевых констант, которые потребуются при расчёте прибыли и рисков. Определили точку безубыточности и другие бизнес-метрики, на основе которых можно принять решение о регионе, в котором будут вести разработки месторождений.

Для достижения точки безубыточности компании необходимо разведать не менее:
- 141 месторождения в Регионе 0, 
- 161 месторождения в Регионе 1,
- 149 месторождений в Регионе 2.

По регионам 0, 1, 2 в каждой скважине в среднем должно быть, соответсвенно, около:
- 157.93 тысяч баррелей нефти, 
- 138.80 тысяч баррелей нефти,
- 149.71 тысяч баррелей нефти.

Построенная модель предсказала средние запасы нефти в скважине:
- 148.37 тысяч баррелей нефти в Регионе 0,
- 138.39 тысяч баррелей нефти в Регионе 1,
- 142.33 тысяч баррелей нефти в Регионе 2.

Модель машинного обучения ошибается в предсказаниях в среднем на:
- 28.23 тысяч баррелей нефти в Регионе 0, 
- 0.580 тысяч баррелей нефти в Регионе 1,
- 30.76 тысяч баррелей нефти в Регионе 2.

При этом останется для разработки скважин, шт:
- 59 скважин в Регионе 0, 
- 39 скважин в Регионе 1, 
- 51 скважин в Регионе 2.

Разработка каждой новой скважины принесёт компании:
- 0.07 млрд. руб. в Регионе 0, 
- 0.06 млрд. руб. в Регионе 1, 
- 0.07 млрд. руб. в Регионе 2.

Разработка всех оставшихся скважин принесёт компании:
- 3.94 млрд. руб. в Регионе 0, 
- 2.43 млрд. руб. в Регионе 1, 
- 3.27 млрд. руб. в Регионе 2.

При указанном количестве скважин, необходимых к разработке, а также при требуемом среднем объёме запасов нефти в каждой скважине, компания получит доход в размере:
- 10.02 млрд. руб. в Регионе 0, 
- 10.06 млрд. руб. в Регионе 1,
- 10.04 млрд. руб. в Регионе 2. 

Это на 0.02 млрд.руб., 0.06 млрд.руб. и 0.04 млрд.руб. больше, чем требуется для достижения точки безубыточности, в 0, 1 и 2 регионах соответственно.

В каждом регионе может быть выбрано для разработки 200 скважин. Поэтому мы рассчитали требуемый, для выхода на точку безубыточности, объём нефти из расчёта на 200 месторождений:
- 111.34 тыс. баррелей нефти для Региона 0, 
- 111.73 тыс. баррелей нефти для Региона 1, 
- 111.54 тыс. баррелей нефти для Региона 2. 

В каждом регионе требуемый для выхода на точку безубыточности объём нефти из расчёта на 200 месторождений выше средних объёмов запасов нефти, предсказанных моделью.

Требуемый для достижения точки безубыточности предсказанный средний объём нефти в скважине при заданном количестве месторождений и необходимом объёме нефти в каждом из них недостаточен для выхода в точку безубыточности в каждом из регионов.

При расчёте требуемого для выхода на точку безубыточности объёма нефти из расчёта на 200 месторождений использовались все предсказанные моделью запасы нефти в регионе - большие и небольшие. Соответственно, регионы с низкими величинами запасов нефти снижали требуемый для выхода на точку безубыточности объём нефти. Поэтому из всех предсказаний необходимо отобрать 200 с наибольшими запасами нефти и оценивать по ним прибыль и риски.


### Расчёт прибыли и рисков

На данном этапе мы рассчитали возможную прибыль от разработки регионов и оценили риски проведения работ в этих регионах.

- Регион 0: 
 - средняя прибыль 0.426 млрд. рублей
 - 5 % - квантиль -0.032 млрд. рублей
 - 95 % - квантиль 0.881 млрд. рублей
 - Риск получить убыток 6 %


- Регион 1:
 - средняя прибыль 0.515 млрд. рублей
 - 5 % - квантиль 0.069 млрд. рублей
 - 95 % - квантиль 0.932 млрд. рублей
 - Риск получить убыток 1 %


- Регион 2:
 - средняя прибыль 0.435 млрд. рублей
 - 5 % - квантиль -0.129 млрд. рублей
 - 95 % - квантиль 0.97 млрд. рублей
 - Риск получить убыток 6.4 % 


Регион 0 и Регион 2 имеют риски получения убытков 6 % и выше со средней прибылью 0.426 и 0.435 млрд. рублей соответственно.
Регион 1, со средней прибылью 0.515 млрд. рублей, почти не подвержен риску убытков - 1 %.

Таким образом, учитывая анализ прибыльности каждого из регионов, а также сопряжённые с работой в регионах риски, можно говорить о том, что наиболее подходящим для разработки месторождений будет Регион 1. Для этого региона характерно наибольшее среди других регионов среднее значение бутстрапированной прибыли, при этом доверительный интервал для истинного среднего значения бутстрапированной прибыли уже, чем интервалы для других регионов. Также для этого региона характерна наименьшая вероятность получения убытка.
